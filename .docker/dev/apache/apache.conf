ServerRoot "/usr/local/apache2"
Listen 80

LoadModule mpm_event_module modules/mod_mpm_event.so
LoadModule authn_file_module modules/mod_authn_file.so
LoadModule authn_core_module modules/mod_authn_core.so
LoadModule authz_host_module modules/mod_authz_host.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule authz_core_module modules/mod_authz_core.so
LoadModule access_compat_module modules/mod_access_compat.so
LoadModule auth_basic_module modules/mod_auth_basic.so
LoadModule reqtimeout_module modules/mod_reqtimeout.so
LoadModule filter_module modules/mod_filter.so
LoadModule mime_module modules/mod_mime.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule env_module modules/mod_env.so
LoadModule headers_module modules/mod_headers.so
LoadModule setenvif_module modules/mod_setenvif.so
LoadModule version_module modules/mod_version.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
LoadModule unixd_module modules/mod_unixd.so
LoadModule status_module modules/mod_status.so
LoadModule autoindex_module modules/mod_autoindex.so
LoadModule dir_module modules/mod_dir.so
LoadModule alias_module modules/mod_alias.so
LoadModule rewrite_module modules/mod_rewrite.so
# Performance: Compression modules
LoadModule deflate_module modules/mod_deflate.so
LoadModule brotli_module modules/mod_brotli.so
# Performance: Cache control
LoadModule expires_module modules/mod_expires.so
# Performance: HTTP/2
LoadModule http2_module modules/mod_http2.so

<IfModule unixd_module>
    User daemon
    Group daemon
</IfModule>

ServerAdmin you@example.com
ServerName localhost

# Enable HTTP/2
Protocols h2 h2c http/1.1

<Directory />
    AllowOverride none
    Require all denied
</Directory>

DocumentRoot "/var/www/html/public"
<Directory "/var/www/html/public">
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
    DirectoryIndex index.php
</Directory>

ErrorLog /proc/self/fd/2
LogLevel warn

LogFormat "%h %l %u %t \"%r\" %>s %b" common
CustomLog /proc/self/fd/1 common

# ============================================
# Performance: Brotli Compression
# ============================================
<IfModule mod_brotli.c>
    # Enable Brotli for these MIME types
    AddOutputFilterByType BROTLI_COMPRESS text/html text/plain text/xml text/css text/javascript
    AddOutputFilterByType BROTLI_COMPRESS application/javascript application/json application/xml
    AddOutputFilterByType BROTLI_COMPRESS image/svg+xml

    # Compression quality: 1 (fastest) to 11 (best compression)
    # 6 is good balance for development (fast build times)
    BrotliCompressionQuality 6

    # Don't compress files smaller than 512 bytes
    BrotliFilterNote Input instream
    BrotliFilterNote Output outstream
    BrotliFilterNote Ratio ratio
</IfModule>

# ============================================
# Performance: Gzip Fallback (if Brotli unavailable)
# ============================================
<IfModule mod_deflate.c>
    <IfModule !mod_brotli.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript
        AddOutputFilterByType DEFLATE application/javascript application/json application/xml
        AddOutputFilterByType DEFLATE image/svg+xml
    </IfModule>
</IfModule>

# ============================================
# Performance: Cache Headers for Static Assets
# ============================================
<IfModule mod_expires.c>
    ExpiresActive On

    # Development: shorter cache for easier debugging
    # Webpack versioned files (app.abc123.js) - 1 week
    <FilesMatch "\.(js|css)$">
        ExpiresDefault "access plus 1 week"
        Header set Cache-Control "public, max-age=604800"
    </FilesMatch>

    # Images and fonts - 1 week
    <FilesMatch "\.(jpg|jpeg|png|gif|svg|ico|webp|woff|woff2|ttf|eot)$">
        ExpiresDefault "access plus 1 week"
        Header set Cache-Control "public, max-age=604800"
    </FilesMatch>

    # PDF files - 1 day (pueden cambiar frecuentemente en dev)
    <FilesMatch "\.pdf$">
        ExpiresDefault "access plus 1 day"
        Header set Cache-Control "public, max-age=86400"
    </FilesMatch>
</IfModule>

Include conf/extra/httpd-vhosts.conf